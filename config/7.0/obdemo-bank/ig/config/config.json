{
  "handler": {
    "type": "DispatchHandler",
    "config": {
      "bindings": [
        {
          "condition": "${request.uri.host == env['MY_POD_IP']}",
          "handler": {
            "name": "router-pod",
            "type": "Router",
            "config": {
              "scanInterval": "disabled",
              "directory": "${openig.configDirectory}/routes-pod"
            }
          }
        },
        {
          "condition": "${request.uri.host != env['MY_POD_IP']}",
          "handler": {
            "name": "router-service",
            "type": "Router",
            "config": {
              "scanInterval": "disabled",
              "directory": "${openig.configDirectory}/routes-service"
            }
          }
        }
      ]
    }
  },
  "heap": [
    {
      "name": "capture",
      "type": "CaptureDecorator",
      "config": {
        "captureEntity": true
      }
    },
    {
      "name": "ReverseProxyHandler",
      "type": "ReverseProxyHandler",
      "capture": [
        "request",
        "response"
      ]
    },
    {
      "name": "JwtSession",
      "type": "JwtSession"
    },
{
    "name" : "ForgeRockClientHandler",
    "type" : "Chain",
    "config" : {
      "filters" : [ "TransactionIdOutboundFilter" ],
      "handler" : "ClientHandler"
    },
    "capture" : [ "response", "request" ]
  }, 
    {
      "name" : "AmService-OBIE",
      "type" : "AmService",
      "config" : {
        "url" : "https://&{am.server.fqdn}/am",
        "realm" : "/",
        "ssoTokenHeader" : "iPlanetDirectoryPro",
        "version" : "6.5.1",
        "agent" : {
          "username" : "ig-agent",
          "passwordSecretId" : "ig.agent.secret"
        },
        "secretsProvider": {
          "type": "Base64EncodedSecretStore",
          "config": {
            "secrets": {
              "ig.agent.secret": "cGFzc3dvcmQ="
            }
          }
        },
        "sessionCache" : {
          "enabled" : false
        },
        "notifications" : {
          "enabled" : false
        }
     }
   }
  ],
  "monitor": true
}
